<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>予約フォーム</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <form id="reserveForm">
    <h2>予約フォーム</h2>
    <label>日付: <input type="date" id="date" required></label>
    <label>時間: <input type="time" id="time" required></label>
    <label>名前: <input type="text" id="name" required></label>
    <label>人数: <input type="number" id="people" min="1" required></label>
    <button type="submit">予約する</button>
  </form>
  
<script>
  async function main() {
    await liff.init({ liffId: "2008097113-pwKWvByv" });
    const profile = await liff.getProfile();

    document.getElementById("reserveForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = {
        date: document.getElementById("date").value,
        time: document.getElementById("time").value,
        name: document.getElementById("name").value,
        people: document.getElementById("people").value,
        userId: profile.userId
      };

      try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbzAxsnkp22jb3S32HpDPXSDlVDIKFqpNfjGQc1LPH4RSXKOSZxhF2nt_TKbC5Ss3-Lj5A/exec", {
          method: "POST",
          body: JSON.stringify(data)
        });
        const text = await res.text();
        alert("予約が完了しました！\n" + text);
        liff.closeWindow();
      } catch (err) {
        alert("予約送信中にエラーが発生しました: " + err);
      }
    });
  }

  main();
</script>
</body>
</html>
